{
  "name": "Client Onboarding Automation",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "client-onboarding",
        "options": {}
      },
      "id": "new-client-webhook",
      "name": "New Client Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [280, 300],
      "webhookId": "client-onboarding-trigger"
    },
    {
      "parameters": {
        "jsCode": "// Process new client data and set up onboarding workflow\nconst clientData = $input.first().json;\n\nconst onboardingPlan = {\n  client: clientData,\n  onboarding_steps: [\n    {\n      id: \"welcome_package\",\n      name: \"Send Welcome Package\",\n      description: \"Send welcome email with company information and next steps\",\n      order: 1,\n      estimated_duration_hours: 0.5,\n      responsible_team: \"account_management\",\n      status: \"pending\",\n      auto_executable: true\n    },\n    {\n      id: \"create_client_portal\",\n      name: \"Create Client Portal\",\n      description: \"Set up dedicated client portal with custom branding\",\n      order: 2,\n      estimated_duration_hours: 1,\n      responsible_team: \"technical\",\n      status: \"pending\",\n      auto_executable: true\n    },\n    {\n      id: \"setup_project_structure\",\n      name: \"Setup Project Structure\",\n      description: \"Create initial project structure and assign team members\",\n      order: 3,\n      estimated_duration_hours: 2,\n      responsible_team: \"project_management\",\n      status: \"pending\",\n      auto_executable: true\n    },\n    {\n      id: \"configure_billing\",\n      name: \"Configure Billing & Payments\",\n      description: \"Set up billing preferences, payment methods, and recurring charges\",\n      order: 4,\n      estimated_duration_hours: 1,\n      responsible_team: \"finance\",\n      status: \"pending\",\n      auto_executable: true\n    },\n    {\n      id: \"setup_communication_channels\",\n      name: \"Setup Communication Channels\",\n      description: \"Create Slack channel, schedule kickoff call, and setup regular check-ins\",\n      order: 5,\n      estimated_duration_hours: 1,\n      responsible_team: \"account_management\",\n      status: \"pending\",\n      auto_executable: true\n    },\n    {\n      id: \"initial_audit_discovery\",\n      name: \"Conduct Initial Audit & Discovery\",\n      description: \"Perform initial website/business audit and discovery session\",\n      order: 6,\n      estimated_duration_hours: 4,\n      responsible_team: \"strategy\",\n      status: \"pending\",\n      auto_executable: false,\n      requires_client_input: true\n    },\n    {\n      id: \"create_strategy_document\",\n      name: \"Create Strategy Document\",\n      description: \"Develop initial strategy and roadmap based on discovery\",\n      order: 7,\n      estimated_duration_hours: 3,\n      responsible_team: \"strategy\",\n      status: \"pending\",\n      auto_executable: false,\n      depends_on: [\"initial_audit_discovery\"]\n    },\n    {\n      id: \"kickoff_meeting\",\n      name: \"Schedule & Conduct Kickoff Meeting\",\n      description: \"Present strategy, timeline, and officially launch partnership\",\n      order: 8,\n      estimated_duration_hours: 2,\n      responsible_team: \"account_management\",\n      status: \"pending\",\n      auto_executable: false,\n      depends_on: [\"create_strategy_document\"]\n    }\n  ],\n  timeline: {\n    estimated_completion_days: 14,\n    start_date: new Date().toISOString(),\n    target_completion: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString()\n  },\n  team_assignments: {\n    account_manager: clientData.assigned_account_manager || \"default-am\",\n    project_manager: clientData.assigned_project_manager || \"default-pm\",\n    strategy_lead: clientData.assigned_strategy_lead || \"default-strategist\"\n  },\n  automation_config: {\n    send_daily_updates: true,\n    auto_escalate_delays: true,\n    client_notification_frequency: \"milestone\", // daily, milestone, weekly\n    internal_reporting: true\n  }\n};\n\nreturn [{ json: onboardingPlan }];"
      },
      "id": "create-onboarding-plan",
      "name": "Create Onboarding Plan",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/clients/{{ $json.client.id }}/onboarding/initialize",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json) }}",
        "options": {}
      },
      "id": "initialize-onboarding",
      "name": "Initialize Client Onboarding",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [720, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/integrations/email/send-template",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"template\": \"client_welcome_package\",\n  \"to\": \"{{ $('Create Onboarding Plan').item.json.client.email }}\",\n  \"cc\": [\"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}@agency.com\"],\n  \"data\": {\n    \"client_name\": \"{{ $('Create Onboarding Plan').item.json.client.name }}\",\n    \"company_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }}\",\n    \"account_manager\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}\",\n    \"project_manager\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.project_manager }}\",\n    \"onboarding_timeline\": \"{{ $('Create Onboarding Plan').item.json.timeline.estimated_completion_days }}\",\n    \"portal_url\": \"https://portal.agency.com/{{ $('Create Onboarding Plan').item.json.client.subdomain }}\",\n    \"next_steps\": [\n      \"Review welcome package and company information\",\n      \"Complete client onboarding questionnaire\",\n      \"Schedule discovery call with strategy team\",\n      \"Await portal access credentials (within 24 hours)\"\n    ],\n    \"contact_information\": {\n      \"phone\": \"+1-555-0123\",\n      \"email\": \"support@agency.com\",\n      \"emergency_contact\": \"urgent@agency.com\"\n    },\n    \"attachments\": [\n      {\n        \"name\": \"Welcome_Package.pdf\",\n        \"description\": \"Complete guide to our services and processes\"\n      },\n      {\n        \"name\": \"Onboarding_Questionnaire.pdf\",\n        \"description\": \"Please complete and return within 3 business days\"\n      }\n    ]\n  },\n  \"priority\": \"high\",\n  \"track_opens\": true,\n  \"track_clicks\": true\n}",
        "options": {}
      },
      "id": "send-welcome-package",
      "name": "Send Welcome Package",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [940, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/client-portals/create",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,\n        "specifyBody": "json",
        "jsonBody": "={\n  \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n  \"portal_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }} Portal\",\n  \"subdomain\": \"{{ $('Create Onboarding Plan').item.json.client.company.toLowerCase().replace(/[^a-z0-9]/g, '-') }}\",\n  \"owner_email\": \"{{ $('Create Onboarding Plan').item.json.client.email }}\",\n  \"owner_name\": \"{{ $('Create Onboarding Plan').item.json.client.name }}\",\n  \"branding\": {\n    \"company_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }}\",\n    \"primary_color\": \"{{ $('Create Onboarding Plan').item.json.client.brand_colors?.primary || '#6366f1' }}\",\n    \"logo_url\": \"{{ $('Create Onboarding Plan').item.json.client.logo_url }}\"\n  },\n  \"initial_widgets\": [\n    \"overview_stats\",\n    \"seo_rankings\",\n    \"website_traffic\",\n    \"recent_activity\"\n  ],\n  \"access_settings\": {\n    \"auth_method\": \"email_link\",\n    \"session_timeout\": 480,\n    \"allow_downloads\": true\n  },\n  \"communication_settings\": {\n    \"email_notifications\": true,\n    \"notification_frequency\": \"weekly\",\n    \"enable_chat\": true\n  }\n}",
        "options": {}
      },
      "id": "create-client-portal",
      "name": "Create Client Portal",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [940, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/projects/create-from-template",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n  \"template_id\": \"{{ $('Create Onboarding Plan').item.json.client.service_type || 'seo_standard' }}\",\n  \"project_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }} - {{ $('Create Onboarding Plan').item.json.client.service_type || 'Digital Marketing' }} Project\",\n  \"project_type\": \"{{ $('Create Onboarding Plan').item.json.client.service_type || 'seo' }}\",\n  \"priority\": \"{{ $('Create Onboarding Plan').item.json.client.priority || 'medium' }}\",\n  \"budget\": {{ $('Create Onboarding Plan').item.json.client.project_budget || 10000 }},\n  \"start_date\": \"{{ $('Create Onboarding Plan').item.json.timeline.start_date }}\",\n  \"estimated_duration_months\": {{ $('Create Onboarding Plan').item.json.client.contract_duration || 6 }},\n  \"team_assignments\": {\n    \"project_manager\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.project_manager }}\",\n    \"account_manager\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}\",\n    \"strategy_lead\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.strategy_lead }}\"\n  },\n  \"auto_create_tasks\": true,\n  \"auto_assign_resources\": true,\n  \"client_portal_visible\": true\n}",
        "options": {}
      },
      "id": "setup-project-structure",
      "name": "Setup Project Structure",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [940, 400],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/billing/client/{{ $('Create Onboarding Plan').item.json.client.id }}/setup",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"payment_terms\": {\n    \"net_days\": {{ $('Create Onboarding Plan').item.json.client.payment_terms?.net_days || 30 }},\n    \"late_fee_percentage\": {{ $('Create Onboarding Plan').item.json.client.payment_terms?.late_fee_percentage || 1.5 }},\n    \"auto_payment\": {{ $('Create Onboarding Plan').item.json.client.auto_payment || false }}\n  },\n  \"billing_preferences\": {\n    \"currency\": \"{{ $('Create Onboarding Plan').item.json.client.currency || 'USD' }}\",\n    \"billing_cycle\": \"{{ $('Create Onboarding Plan').item.json.client.billing_cycle || 'monthly' }}\",\n    \"invoice_delivery\": \"email\",\n    \"auto_send_invoices\": true\n  },\n  \"services\": [\n    {\n      \"service_type\": \"{{ $('Create Onboarding Plan').item.json.client.service_type || 'seo' }}\",\n      \"billing_type\": \"{{ $('Create Onboarding Plan').item.json.client.billing_type || 'monthly' }}\",\n      \"amount\": {{ $('Create Onboarding Plan').item.json.client.monthly_retainer || 2500 }},\n      \"start_date\": \"{{ $('Create Onboarding Plan').item.json.timeline.start_date }}\",\n      \"auto_renew\": true\n    }\n  ],\n  \"setup_fee\": {{ $('Create Onboarding Plan').item.json.client.setup_fee || 500 }},\n  \"create_setup_invoice\": true,\n  \"payment_methods\": {\n    \"stripe_customer_id\": \"{{ $('Create Onboarding Plan').item.json.client.stripe_customer_id }}\",\n    \"preferred_method\": \"{{ $('Create Onboarding Plan').item.json.client.preferred_payment_method || 'credit_card' }}\"\n  }\n}",
        "options": {}
      },
      "id": "configure-billing",
      "name": "Configure Billing Setup",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [940, 500],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/integrations/slack/channel/create",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"channel_name\": \"client-{{ $('Create Onboarding Plan').item.json.client.company.toLowerCase().replace(/[^a-z0-9]/g, '-') }}\",\n  \"purpose\": \"Dedicated communication channel for {{ $('Create Onboarding Plan').item.json.client.company }}\",\n  \"private\": false,\n  \"invite_users\": [\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}\",\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.project_manager }}\",\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.strategy_lead }}\"\n  ],\n  \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n  \"pin_welcome_message\": true,\n  \"welcome_message\": \"Welcome to the {{ $('Create Onboarding Plan').item.json.client.company }} project channel! 🚀\\n\\n**Client:** {{ $('Create Onboarding Plan').item.json.client.name }}\\n**Company:** {{ $('Create Onboarding Plan').item.json.client.company }}\\n**Service:** {{ $('Create Onboarding Plan').item.json.client.service_type }}\\n**Project Start:** {{ new Date($('Create Onboarding Plan').item.json.timeline.start_date).toLocaleDateString() }}\\n\\nLet's deliver amazing results! 💪\"\n}",
        "options": {}
      },
      "id": "create-slack-channel",
      "name": "Create Client Slack Channel",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [940, 600],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/calendar/schedule-meeting",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"meeting_type\": \"discovery_call\",\n  \"title\": \"{{ $('Create Onboarding Plan').item.json.client.company }} - Discovery & Strategy Session\",\n  \"duration_minutes\": 90,\n  \"attendees\": [\n    {\n      \"email\": \"{{ $('Create Onboarding Plan').item.json.client.email }}\",\n      \"name\": \"{{ $('Create Onboarding Plan').item.json.client.name }}\",\n      \"role\": \"client\"\n    },\n    {\n      \"email\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}@agency.com\",\n      \"role\": \"account_manager\"\n    },\n    {\n      \"email\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.strategy_lead }}@agency.com\",\n      \"role\": \"strategy_lead\"\n    }\n  ],\n  \"preferred_times\": [\n    {\n      \"date\": \"{{ new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] }}\",\n      \"time_slots\": [\"10:00\", \"14:00\", \"15:30\"]\n    },\n    {\n      \"date\": \"{{ new Date(Date.now() + 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] }}\",\n      \"time_slots\": [\"09:00\", \"11:00\", \"13:00\"]\n    }\n  ],\n  \"meeting_agenda\": [\n    \"Welcome and introductions\",\n    \"Review current digital presence\",\n    \"Discuss business goals and objectives\",\n    \"Identify opportunities and challenges\",\n    \"Present initial strategy recommendations\",\n    \"Define success metrics and KPIs\",\n    \"Outline project timeline and next steps\"\n  ],\n  \"preparation_materials\": [\n    \"Current website analytics (if available)\",\n    \"List of current marketing activities\",\n    \"Competitor analysis (internal)\",\n    \"Business objectives and goals documentation\"\n  ],\n  \"auto_send_calendar_invite\": true,\n  \"send_reminder_24h\": true,\n  \"send_reminder_2h\": true,\n  \"include_zoom_link\": true\n}",
        "options": {}
      },
      "id": "schedule-discovery-call",
      "name": "Schedule Discovery Call",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1160, 400],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/integrations/email/send-template",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"template\": \"portal_access_credentials\",\n  \"to\": \"{{ $('Create Onboarding Plan').item.json.client.email }}\",\n  \"subject\": \"Your Client Portal is Ready - {{ $('Create Onboarding Plan').item.json.client.company }}\",\n  \"data\": {\n    \"client_name\": \"{{ $('Create Onboarding Plan').item.json.client.name }}\",\n    \"company_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }}\",\n    \"portal_url\": \"https://portal.agency.com/{{ $('Create Client Portal').item.json.portal.subdomain }}\",\n    \"login_method\": \"email_link\",\n    \"features\": [\n      \"Real-time project progress tracking\",\n      \"Performance metrics and analytics\",\n      \"Direct communication with your team\",\n      \"Document and report downloads\",\n      \"Invoice and billing management\"\n    ],\n    \"support_contact\": \"support@agency.com\",\n    \"account_manager\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}\"\n  },\n  \"priority\": \"high\"\n}",
        "options": {}
      },
      "id": "send-portal-credentials",
      "name": "Send Portal Access Credentials",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1160, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/notifications/internal/send",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"notification_type\": \"client_onboarding_started\",\n  \"title\": \"🎉 New Client Onboarding: {{ $('Create Onboarding Plan').item.json.client.company }}\",\n  \"message\": \"Client onboarding automation has been initiated for {{ $('Create Onboarding Plan').item.json.client.company }}. All initial setup steps are in progress.\",\n  \"recipients\": [\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}@agency.com\",\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.project_manager }}@agency.com\",\n    \"{{ $('Create Onboarding Plan').item.json.team_assignments.strategy_lead }}@agency.com\",\n    \"management@agency.com\"\n  ],\n  \"data\": {\n    \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n    \"company_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }}\",\n    \"service_type\": \"{{ $('Create Onboarding Plan').item.json.client.service_type }}\",\n    \"monthly_value\": {{ $('Create Onboarding Plan').item.json.client.monthly_retainer || 0 }},\n    \"project_budget\": {{ $('Create Onboarding Plan').item.json.client.project_budget || 0 }},\n    \"estimated_completion\": \"{{ $('Create Onboarding Plan').item.json.timeline.target_completion }}\",\n    \"portal_url\": \"https://portal.agency.com/{{ $('Create Client Portal').item.json.portal.subdomain }}\",\n    \"slack_channel\": \"#client-{{ $('Create Onboarding Plan').item.json.client.company.toLowerCase().replace(/[^a-z0-9]/g, '-') }}\"\n  },\n  \"priority\": \"normal\",\n  \"channels\": [\"email\", \"slack\"]\n}",
        "options": {}
      },
      "id": "notify-team",
      "name": "Notify Internal Team",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1160, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/automation/schedule-follow-up",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"follow_up_type\": \"onboarding_progress\",\n  \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n  \"schedule\": [\n    {\n      \"delay_hours\": 24,\n      \"action\": \"check_email_opened\",\n      \"description\": \"Check if welcome email was opened, send reminder if not\"\n    },\n    {\n      \"delay_hours\": 72,\n      \"action\": \"questionnaire_reminder\",\n      \"description\": \"Send reminder to complete onboarding questionnaire\"\n    },\n    {\n      \"delay_hours\": 168,\n      \"action\": \"discovery_call_reminder\",\n      \"description\": \"Reminder about upcoming discovery call\"\n    },\n    {\n      \"delay_hours\": 336,\n      \"action\": \"onboarding_completion_check\",\n      \"description\": \"Check onboarding progress and escalate if needed\"\n    }\n  ],\n  \"escalation_rules\": {\n    \"no_response_after_hours\": 168,\n    \"escalate_to\": \"{{ $('Create Onboarding Plan').item.json.team_assignments.account_manager }}@agency.com\",\n    \"cc_management\": true\n  },\n  \"success_triggers\": [\n    \"questionnaire_completed\",\n    \"discovery_call_completed\",\n    \"first_invoice_paid\",\n    \"portal_first_login\"\n  ]\n}",
        "options": {}
      },
      "id": "schedule-follow-ups",
      "name": "Schedule Automated Follow-ups",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1380, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:3002/api/analytics/client/{{ $('Create Onboarding Plan').item.json.client.id }}/onboarding-started",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"event_type\": \"client_onboarding_automation\",\n  \"client_data\": {\n    \"client_id\": \"{{ $('Create Onboarding Plan').item.json.client.id }}\",\n    \"company_name\": \"{{ $('Create Onboarding Plan').item.json.client.company }}\",\n    \"service_type\": \"{{ $('Create Onboarding Plan').item.json.client.service_type }}\",\n    \"monthly_value\": {{ $('Create Onboarding Plan').item.json.client.monthly_retainer || 0 }},\n    \"acquisition_source\": \"{{ $('Create Onboarding Plan').item.json.client.acquisition_source }}\"\n  },\n  \"onboarding_metrics\": {\n    \"total_steps\": {{ $('Create Onboarding Plan').item.json.onboarding_steps.length }},\n    \"automated_steps\": {{ $('Create Onboarding Plan').item.json.onboarding_steps.filter(step => step.auto_executable).length }},\n    \"estimated_completion_days\": {{ $('Create Onboarding Plan').item.json.timeline.estimated_completion_days }},\n    \"team_members_assigned\": 3\n  },\n  \"automation_success\": {\n    \"welcome_email_sent\": true,\n    \"portal_created\": true,\n    \"project_structure_setup\": true,\n    \"billing_configured\": true,\n    \"communication_channels_setup\": true\n  },\n  \"timestamp\": \"{{ new Date().toISOString() }}\"\n}",
        "options": {}
      },
      "id": "update-analytics",
      "name": "Update Onboarding Analytics",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1380, 500],
      "credentials": {
        "httpHeaderAuth": {
          "id": "api-key-auth",
          "name": "API Key Auth"
        }
      }
    }
  ],
  "connections": {
    "New Client Webhook": {
      "main": [
        [
          {
            "node": "Create Onboarding Plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Onboarding Plan": {
      "main": [
        [
          {
            "node": "Initialize Client Onboarding",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Initialize Client Onboarding": {
      "main": [
        [
          {
            "node": "Send Welcome Package",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create Client Portal",
            "type": "main",
            "index": 0
          },
          {
            "node": "Setup Project Structure",
            "type": "main",
            "index": 0
          },
          {
            "node": "Configure Billing Setup",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create Client Slack Channel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Welcome Package": {
      "main": [
        [
          {
            "node": "Notify Internal Team",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Client Portal": {
      "main": [
        [
          {
            "node": "Send Portal Access Credentials",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Setup Project Structure": {
      "main": [
        [
          {
            "node": "Schedule Discovery Call",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Configure Billing Setup": {
      "main": [
        [
          {
            "node": "Schedule Automated Follow-ups",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Client Slack Channel": {
      "main": [
        [
          {
            "node": "Update Onboarding Analytics",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Portal Access Credentials": {
      "main": [
        [
          {
            "node": "Schedule Automated Follow-ups",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notify Internal Team": {
      "main": [
        [
          {
            "node": "Schedule Automated Follow-ups",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "America/New_York"
  },
  "versionId": "client-onboarding-v2.0.0",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "id": "client-onboarding-automation",
  "tags": [
    {
      "createdAt": "2024-12-19T00:00:00.000Z",
      "updatedAt": "2024-12-19T00:00:00.000Z",
      "id": "4",
      "name": "onboarding"
    },
    {
      "createdAt": "2024-12-19T00:00:00.000Z",
      "updatedAt": "2024-12-19T00:00:00.000Z",
      "id": "5",
      "name": "client-management"
    }
  ]
}